# SNI Proxy Configuration
# Проксирование HTTPS трафика на основе SNI (Server Name Indication)

user daemon
pidfile /var/run/sniproxy.pid

resolver {
    nameserver 8.8.8.8
    nameserver 1.1.1.1
    mode ipv4_only
}

listener 0.0.0.0:80 {
    proto http
    table http_hosts
    access_log {
        filename /dev/stdout
    }
}

listener 0.0.0.0:443 {
    proto tls
    table https_hosts
    access_log {
        filename /dev/stdout
    }
}

# HTTP таблица маршрутизации
table http_hosts {
    # Игры (Supercell)
    .*\.brawlstars\.com$ *
    brawlstars\.com$ *
    .*\.supercell\.com$ *
    supercell\.com$ *
    .*\.supercell\.net$ *
    supercell\.net$ *
    .*\.clashofclans\.com$ *
    clashofclans\.com$ *
    .*\.clashroyale\.com$ *
    clashroyale\.com$ *
    
    # Instagram
    .*\.instagram\.com$ *
    instagram\.com$ *
    .*\.cdninstagram\.com$ *
    
    # Facebook
    .*\.facebook\.com$ *
    facebook\.com$ *
    .*\.fbcdn\.net$ *
    .*\.facebook\.net$ *
    .*\.fb\.com$ *
    fb\.com$ *
    
    # Twitter / X
    .*\.twitter\.com$ *
    twitter\.com$ *
    .*\.x\.com$ *
    x\.com$ *
    .*\.twimg\.com$ *
    t\.co$ *
    
    # Threads
    .*\.threads\.net$ *
    threads\.net$ *
    
    # Discord
    .*\.discord\.com$ *
    discord\.com$ *
    .*\.discordapp\.com$ *
    discordapp\.com$ *
    .*\.discord\.gg$ *
    discord\.gg$ *
    .*\.discordapp\.net$ *
    
    # LinkedIn
    .*\.linkedin\.com$ *
    linkedin\.com$ *
    .*\.licdn\.com$ *
    
    # Spotify
    .*\.spotify\.com$ *
    spotify\.com$ *
    .*\.spotifycdn\.com$ *
    .*\.scdn\.co$ *
    
    # SoundCloud
    .*\.soundcloud\.com$ *
    soundcloud\.com$ *
    .*\.sndcdn\.com$ *
    
    # Netflix
    .*\.netflix\.com$ *
    netflix\.com$ *
    .*\.nflxvideo\.net$ *
    .*\.nflximg\.net$ *
    
    # Twitch
    .*\.twitch\.tv$ *
    twitch\.tv$ *
    .*\.ttvnw\.net$ *
    
    # OpenAI / ChatGPT
    .*\.openai\.com$ *
    openai\.com$ *
    
    # Notion
    .*\.notion\.so$ *
    notion\.so$ *
    .*\.notion\.com$ *
    notion\.com$ *
    
    # Medium
    .*\.medium\.com$ *
    medium\.com$ *
    
    # Patreon
    .*\.patreon\.com$ *
    patreon\.com$ *
    
    # BBC
    .*\.bbc\.com$ *
    bbc\.com$ *
    .*\.bbc\.co\.uk$ *
    bbc\.co\.uk$ *
    
    # Archive.org
    .*\.archive\.org$ *
    archive\.org$ *
    
    # ProtonMail
    .*\.protonmail\.com$ *
    protonmail\.com$ *
    .*\.proton\.me$ *
    proton\.me$ *
    
    # PayPal
    .*\.paypal\.com$ *
    paypal\.com$ *
}

# HTTPS таблица маршрутизации (та же что и HTTP)
table https_hosts {
    # Игры (Supercell)
    .*\.brawlstars\.com$ *
    brawlstars\.com$ *
    .*\.supercell\.com$ *
    supercell\.com$ *
    .*\.supercell\.net$ *
    supercell\.net$ *
    .*\.clashofclans\.com$ *
    clashofclans\.com$ *
    .*\.clashroyale\.com$ *
    clashroyale\.com$ *
    
    # Instagram
    .*\.instagram\.com$ *
    instagram\.com$ *
    .*\.cdninstagram\.com$ *
    
    # Facebook
    .*\.facebook\.com$ *
    facebook\.com$ *
    .*\.fbcdn\.net$ *
    .*\.facebook\.net$ *
    .*\.fb\.com$ *
    fb\.com$ *
    
    # Twitter / X
    .*\.twitter\.com$ *
    twitter\.com$ *
    .*\.x\.com$ *
    x\.com$ *
    .*\.twimg\.com$ *
    t\.co$ *
    
    # Threads
    .*\.threads\.net$ *
    threads\.net$ *
    
    # Discord
    .*\.discord\.com$ *
    discord\.com$ *
    .*\.discordapp\.com$ *
    discordapp\.com$ *
    .*\.discord\.gg$ *
    discord\.gg$ *
    .*\.discordapp\.net$ *
    
    # LinkedIn
    .*\.linkedin\.com$ *
    linkedin\.com$ *
    .*\.licdn\.com$ *
    
    # Spotify
    .*\.spotify\.com$ *
    spotify\.com$ *
    .*\.spotifycdn\.com$ *
    .*\.scdn\.co$ *
    
    # SoundCloud
    .*\.soundcloud\.com$ *
    soundcloud\.com$ *
    .*\.sndcdn\.com$ *
    
    # Netflix
    .*\.netflix\.com$ *
    netflix\.com$ *
    .*\.nflxvideo\.net$ *
    .*\.nflximg\.net$ *
    
    # Twitch
    .*\.twitch\.tv$ *
    twitch\.tv$ *
    .*\.ttvnw\.net$ *
    
    # OpenAI / ChatGPT
    .*\.openai\.com$ *
    openai\.com$ *
    
    # Notion
    .*\.notion\.so$ *
    notion\.so$ *
    .*\.notion\.com$ *
    notion\.com$ *
    
    # Medium
    .*\.medium\.com$ *
    medium\.com$ *
    
    # Patreon
    .*\.patreon\.com$ *
    patreon\.com$ *
    
    # BBC
    .*\.bbc\.com$ *
    bbc\.com$ *
    .*\.bbc\.co\.uk$ *
    bbc\.co\.uk$ *
    
    # Archive.org
    .*\.archive\.org$ *
    archive\.org$ *
    
    # ProtonMail
    .*\.protonmail\.com$ *
    protonmail\.com$ *
    .*\.proton\.me$ *
    proton\.me$ *
    
    # PayPal
    .*\.paypal\.com$ *
    paypal\.com$ *
}
